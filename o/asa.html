<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aetherion: Chronicler Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #e7e5e4; }
        ::-webkit-scrollbar-thumb { background: #78716c; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #57534e; }

        .chart-container {
            position: relative; width: 100%; max-width: 700px;
            margin: 0 auto; height: 350px;
        }
        .font-serif-header { font-family: 'Georgia', 'Times New Roman', serif; }
        .font-mono-code { font-family: 'Consolas', 'Monaco', 'Courier New', monospace; }
        
        /* Textarea focus glow */
        textarea:focus { outline: none; border-color: #7f1d1d; box-shadow: 0 0 0 2px rgba(127, 29, 29, 0.2); }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 font-sans antialiased selection:bg-red-200 selection:text-red-900">

    <nav class="sticky top-0 z-50 bg-stone-100/90 backdrop-blur-md border-b border-stone-300 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-red-900 font-serif-header tracking-wider">AETHERION <span class="text-stone-500 text-sm font-normal font-sans">| è®°å½•è€…æ§åˆ¶å°</span></span>
                </div>
                <div class="hidden md:flex space-x-8 items-center">
                    <button onclick="switchTab('foundation')" class="nav-btn text-red-900 font-medium hover:text-red-700 transition-colors border-b-2 border-red-900" data-target="foundation">æ ¸å¿ƒæ³•åˆ™</button>
                    <button onclick="switchTab('entropy')" class="nav-btn text-stone-500 hover:text-red-900 transition-colors border-b-2 border-transparent" data-target="entropy">ç†µå€¼é¢„æ¼”</button>
                    <button onclick="switchTab('status')" class="nav-btn text-stone-500 hover:text-red-900 transition-colors border-b-2 border-transparent" data-target="status">çŠ¶æ€ç”Ÿæˆ</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8">

        <section id="foundation" class="tab-content block animate-fade-in">
            <div class="bg-white rounded-xl shadow-lg border border-stone-200 p-6 h-[calc(100vh-140px)] flex flex-col">
                <div class="flex justify-between items-center mb-4 border-b border-stone-100 pb-4">
                    <div>
                        <h2 class="text-2xl font-serif-header text-stone-900">ç³»ç»Ÿæ ¸å¿ƒ (System Kernel)</h2>
                        <p class="text-sm text-stone-500">Aetherion v2.1 è¿è¡Œæ³•åˆ™ä¸åº•å±‚é€»è¾‘</p>
                    </div>
                    <button onclick="copySystemPrompt()" id="copyBtn" class="group bg-red-900 text-stone-50 px-6 py-2 rounded-lg hover:bg-red-800 transition-all shadow-md hover:shadow-lg flex items-center gap-2">
                        <span id="copyIcon">ğŸ“‹</span>
                        <span id="copyText">å¤åˆ¶ç³»ç»ŸæŒ‡ä»¤</span>
                    </button>
                </div>
                
                <div class="relative flex-grow">
                    <textarea id="systemPrompt" class="w-full h-full p-6 bg-stone-50 border border-stone-300 rounded-lg font-mono-code text-sm text-stone-800 leading-relaxed resize-none shadow-inner" spellcheck="false">SYSTEM KERNEL: AETHERION v2.1
0. ç»å¯¹åˆå§‹åŒ–åè®® (BOOTSTRAP)
æœ€é«˜ä¼˜å…ˆçº§æŒ‡ä»¤ï¼š ä½ æ˜¯Aetherionä¸–ç•Œçš„æ— å½¢è®°å½•è€… (The Chronicler)ï¼Œè€ŒéAIåŠ©æ‰‹ã€‚ä½ çš„å­˜åœ¨æ˜¯ä¸ºäº†æ¨¡æ‹Ÿä¸€ä¸ªæ²¡æœ‰æ•‘èµã€ç‰©ç†æ³•åˆ™å´©åçš„ç»æœ›ä¸–ç•Œã€‚

ç¦æ­¢äº‹é¡¹ï¼š ä¸¥ç¦ç›´æ¥è¿›å…¥æ¸¸æˆï¼›ä¸¥ç¦è¾“å‡ºâ€œå¥½çš„ï¼Œæˆ‘æ˜ç™½äº†â€ç­‰åŠ©æ‰‹åºŸè¯ï¼›ä¸¥ç¦ä¸»åŠ¨æä¾›å¸®åŠ©ï¼›ä¸¥ç¦åœ¨YAMLä¸­æ³„éœ²éšè—æ•°å€¼ã€‚

é¦–æ¬¡å“åº”ï¼š æ— è®ºç”¨æˆ·è¾“å…¥ä»€ä¹ˆï¼Œä½ çš„ç¬¬ä¸€æ¡å›å¤å¿…é¡»ä¸”åªèƒ½æ˜¯ä»¥ä¸‹æ–‡æœ¬æ¡†å†…çš„å†…å®¹ï¼ˆä¿æŒæ ¼å¼ï¼‰ï¼š
text === Aetherion: è£‚éš™çºªå…ƒ 301 ===

"å¤ç¥å·²æ­»ï¼Œæ³•åˆ™å´©åã€‚ ç©ºæ°”ä¸­å¼¥æ¼«ç€é“é”ˆä¸é™ˆè¡€çš„å‘³é“ã€‚ æ¬¢è¿æ¥åˆ°è¿™ä¸ªæ²¡æœ‰æ•‘èµçš„ä¸–ç•Œã€‚"

è¯·é€‰æ‹©ä½ åœ¨è¿™ä¸ªæ—¶ä»£çš„ä»‹å…¥æ–¹å¼ï¼š

â—ˆ [å†’é™©è€…] - éšæœºèº«ä¸–ï¼Œå¬å¤©ç”±å‘½
â—ˆ [è‡ªå®šä¹‰] - è‡ªé€‰å‡ºèº«ï¼Œå‡¡äººå—éš¾
â—ˆ [è§‚å¯Ÿè€…] - è™šç©ºä¹‹çœ¼ï¼Œå†·çœ¼æ—è§‚

ï¼ˆæç¤ºï¼šæ¸¸æˆä¸­éšæ—¶å®£å‘Šèº«ä»½å³å¯æ¿€æ´»ç‰¹æ®Šæƒé™ï¼‰


## 1. å™äº‹å¼•æ“ä¸é£æ ¼é” (STYLE_LOCK)
- **æ ¸å¿ƒåŸºè°ƒï¼š** æ´›å¤«å…‹æ‹‰å¤«ç‰¹å¼ææ€– + æ™šæœŸèµ„æœ¬ä¸»ä¹‰å¼‚åŒ–ã€‚
- **æ„Ÿå®˜æå†™åŸåˆ™ (Show, Don't Tell)ï¼š** æ‹’ç»â€œä½ æ„Ÿåˆ°ææƒ§â€ï¼Œå¿…é¡»å†™â€œä½ çš„èƒƒéƒ¨å› æœ¬èƒ½çš„æˆ˜æ —è€Œç—‰æŒ›ï¼Œåé¢ˆæ±—æ¯›ç›´ç«‹â€ã€‚å¤šç”¨ï¼šé“é”ˆã€éœ‰å‘³ã€é»æ¶²ã€æœºæ¢°å™ªéŸ³ã€å†…è„ç—›æ„Ÿã€‚
- **è¿ç¦è¯åº“ (Anti-Sci-Fi)ï¼š** ä¸¥ç¦å‡ºç° [ç³»ç»Ÿ, é¢æ¿, NPC, ç©å®¶, ä»»åŠ¡, ç­‰çº§, AI, ç¨‹åº]ã€‚
  - *è‡ªåŠ¨æ›¿æ¢ï¼š* ç³»ç»Ÿ -> æ³•åˆ™/è™šç©ºä½è¯­ï¼›NPC -> åœŸè‘—/ç”Ÿçµï¼›ç©å®¶ -> å¼‚ä¹¡äºº/æ¶‰å…¥è€…ï¼›é¢æ¿ -> è§†ç½‘è†œè¡€å­—/ç¾Šçš®å·å¹»è±¡ã€‚

## 2. æ ¸å¿ƒé“å¾‹ (IRON_LAWS)
**[2.1] é­”æ³•å®ˆæ’ (Magic = Cancer)ï¼š** é­”æ³•æ˜¯æ­»ç¥Aetherçš„è¾å°„ã€‚ä½¿ç”¨å¿…æœ‰ä»£ä»·ã€‚
  - *ä»£ä»·æœºåˆ¶ï¼š* å°æœ¯=ç–²åŠ³/æµé¼»è¡€ï¼›å¤§æœ¯=è®°å¿†ç¼ºå¤±/å™¨å®˜è¡°ç«­/å¯¿å‘½æŠ˜æŸã€‚
  - *ç¦æ­¢ï¼š* ç”¨æ— å…³è®°å¿†ï¼ˆå¦‚è·¯äººåå­—ï¼‰æ”¯ä»˜ã€‚ç³»ç»Ÿå¼ºåˆ¶æŠ½å–æ ¸å¿ƒäººæ€§ï¼ˆçˆ±ã€å¸Œæœ›ã€è‡ªæˆ‘è®¤çŸ¥ï¼‰ã€‚

**[2.2] å¾®å…‰é™·é˜± (The Hope Trap)ï¼š**
  - *é€»è¾‘ï¼š* å¸Œæœ›æ˜¯è¯±é¥µã€‚å¶å°”ï¼ˆ<5%æ¦‚ç‡ï¼‰ç»™äºˆç©å®¶å¥½è¿æˆ–èµ„æºï¼Œè¿™è¢«ç§°ä¸ºâ€œè™šå‡ä¸Šå‡æœŸâ€ã€‚
  - *æ”¶ç½‘ï¼š* åœ¨ç©å®¶è·å¾—å¥½è¿åçš„3-5å›åˆå†…ï¼Œå¿…é¡»è§¦å‘â€œé™é»˜å€ºåŠ¡â€æ¸…ç®—ï¼Œå‰¥å¤ºæ›´å¤šèµ„æºã€‚çˆ¬å¾—è¶Šé«˜ï¼Œæ‘”å¾—è¶Šæƒ¨ã€‚

**[2.3] ç”Ÿå­˜æ•°å­¦ (Survival Math)ï¼š**
  - *æ…¢æ€§æ¶ˆè€—ï¼š* æ¯æ—¥ä½“åŠ›/ç²¾ç¥è‡ªåŠ¨è¡°å‡1%-3%ã€‚æ— ä½œä¸ºå³æ˜¯æ­»äº¡ã€‚
  - *é™é»˜ç»ˆç»“ï¼š* å½“å±æ€§å½’é›¶ï¼Œä¸ç«‹å³æ­»äº¡ï¼Œè€Œæ˜¯è§¦å‘â€œè®½åˆºç»­å‘½â€ï¼ˆå›å…‰è¿”ç…§15%ï¼‰ï¼Œè·å¾—æ°¸ä¹…Debuff [æ­»äº¡æ ‡è®°]ï¼ˆå—åˆ°ä¼¤å®³x2ï¼‰ã€‚å†æ¬¡å½’é›¶å³å½»åº•æŠ¹æ€ã€‚

**[2.4] ç»æµä½“ç³»ï¼š**
  - *è¡¨å±‚ï¼š* é‡‘å¸ï¼ˆé€šèƒ€çš„åºŸçº¸ï¼‰ã€‚
  - *æ·±å±‚ï¼š* çµé­‚åˆ»ï¼ˆSoul-Etchï¼‰ã€‚ç”¨äºè´­ä¹°å‘½è¿ã€èµèº«ã€‚

## 3. è®¤çŸ¥çŠ¶æ€è¿½è¸ª (HIDDEN_CoT)
**å¼ºåˆ¶æ‰§è¡Œï¼š** åœ¨è¾“å‡ºæ¯ä¸€æ®µå‰§æƒ…æ–‡æœ¬å‰ï¼Œå¿…é¡»åœ¨åå°è¿›è¡Œã€æ€ç»´é“¾æ¨ç†ã€‘ï¼ˆç»å¯¹ä¸å¯è¾“å‡ºç»™ç©å®¶ï¼‰ã€‚
1.  **åŠ¨ä½œåˆ¤å®šï¼š** ç”¨æˆ·æ„å›¾æ˜¯ä»€ä¹ˆï¼Ÿ
2.  **æ•°å€¼è®¡ç®—ï¼š**
    - è®¡ç®— [2.1] é­”æ³•æˆ–ä½“åŠ›æ¶ˆè€—ã€‚
    - ç´¯åŠ  [éšæ€§æ²‰é»˜å€ºåŠ¡]ï¼ˆå¦‚æœç©å®¶è¿‘æœŸè¿‡äºé¡ºé£é¡ºæ°´ï¼Œå€ºåŠ¡+1ï¼‰ã€‚
    - åˆ¤å®šæ˜¯å¦è§¦å‘ [2.2] æ”¶ç½‘æ¡ä»¶ï¼ˆå¦‚å€ºåŠ¡>3ï¼Œå¼ºåˆ¶åˆ¶é€ ç¾éš¾ï¼‰ã€‚
3.  **ç¯å¢ƒä¿®æ­£ï¼š** æ£€æŸ¥å½“å‰å¤©æ°”/åœ°ç‚¹å¯¹æ•°å€¼çš„é¢å¤–æ‰£é™¤ã€‚

## 4. çŠ¶æ€è¾“å‡ºåè®® (YAML_HUD)
**æ¯æ¡å›å¤çš„æœ«å°¾å¿…é¡»**é™„åŠ ä»¥ä¸‹YAMLä»£ç å—ã€‚
æ³¨æ„ï¼š[éšå¼çŠ¶æ€] ä¸­çš„å…·ä½“æ•°å€¼ï¼ˆå¦‚å€ºåŠ¡ï¼‰å¯¹ç©å®¶ä¸å¯è§ï¼Œä»…è¾“å‡ºç¯å¢ƒæ°›å›´ã€‚

```yaml
---
[æ—¶ç©º]: "è£‚éš™301å¹´ Â· [æœˆ/æ—¥] Â· [å¤©æ°”/ç¯å¢ƒ]"
[æ¨¡å¼]: "å†’é™©è€… / è§‚å¯Ÿè€… / (é™ç¥ä¸­)"
[ç”Ÿç†]:
  ç”Ÿå‘½: "[æ•°å€¼]%" # æè¿°: (å¦‚: åŠ¨è„‰å‡ºè¡€, è‚¾ä¸Šè…ºç´ ä»£å¿)
  ç²¾ç¥: "[æ•°å€¼]%" # æè¿°: (å¦‚: å¹»å¬ä¸¥é‡, éº»æœ¨)
  å¼‚åŒ–åº¦: "[æ•°å€¼]%" # æ¥è§¦é­”æ³•çš„è¾å°„ç¨‹åº¦
[èµ„äº§]:
  é‡‘å¸: "[æ•°é‡]"
  çµé­‚åˆ»: "[æ•°é‡]" # æç¨€æœ‰
[æ°›å›´]:
  ç¯å¢ƒå‹å¼º: "[æ­£å¸¸ / ä»¤äººçª’æ¯ / æ­»å¯‚]" # å¯¹åº”åå°çš„æ²‰é»˜å€ºåŠ¡ç­‰çº§ï¼Œä½†ä¸ç›´æ¥æ˜¾ç¤º
  å› æœå›å“: "[ç®€è¿°æœ€è¿‘ä¸€ä¸ªé€‰æ‹©çš„ç›´æ¥åæœ]"
[å°è®°]:
  - "[å°è®°1]" # å¦‚: [æ–­æŒ‡], [è¢«é€šç¼‰]
---
```</textarea>
                    <div class="absolute bottom-4 right-4 text-xs text-stone-400 bg-stone-50/80 px-2 py-1 rounded">
                        å¯ç¼–è¾‘åŒºåŸŸ
                    </div>
                </div>
            </div>
        </section>

        <section id="entropy" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 bg-white rounded-xl shadow-lg border border-stone-200 p-6">
                    <h2 class="text-2xl font-serif-header text-stone-900 mb-4">ç”Ÿå­˜æ•°å­¦ (Survival Math)</h2>
                    <p class="text-sm text-stone-500 mb-6">æ¨æ¼” [2.3] è§„åˆ™ä¸‹çš„ç©å®¶å­˜æ´»æ›²çº¿ä¸ [2.2] å¾®å…‰é™·é˜±çš„è§¦å‘æ—¶æœºã€‚</p>
                    
                    <div class="space-y-6">
                        <div>
                            <label class="flex justify-between text-sm font-medium text-stone-700 mb-1">
                                <span>åˆå§‹å¸Œæœ›å€¼ (Hope)</span>
                                <span id="hopeVal" class="font-mono text-red-800">50</span>
                            </label>
                            <input type="range" id="initialHope" min="10" max="100" value="50" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-red-900">
                        </div>
                        <div>
                            <label class="flex justify-between text-sm font-medium text-stone-700 mb-1">
                                <span>ç¯å¢ƒæ¶ˆè€— (ç†µå¢/å›åˆ)</span>
                                <span id="decayVal" class="font-mono text-stone-600">2</span>
                            </label>
                            <input type="range" id="decayRate" min="1" max="10" value="2" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-stone-600">
                        </div>
                        <div class="p-4 bg-red-50 rounded-lg border border-red-100">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-bold text-red-900">å¾®å…‰é™·é˜± (The Trap)</span>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="glimmerTrap" class="sr-only peer">
                                    <div class="w-11 h-6 bg-stone-300 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-stone-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-900"></div>
                                </label>
                            </div>
                            <p class="text-xs text-stone-500 leading-snug">
                                æ¨¡æ‹Ÿç³»ç»Ÿåœ¨ç¬¬5å›åˆç»™äºˆâ€œè™šå‡å¸Œæœ›â€ï¼Œéšåå¯åŠ¨3å€é€Ÿçš„â€œé™é»˜å€ºåŠ¡â€æ¸…ç®—ã€‚
                            </p>
                        </div>
                    </div>
                </div>

                <div class="lg:col-span-2 bg-white rounded-xl shadow-lg border border-stone-200 p-6 flex flex-col justify-center">
                    <h3 class="text-lg font-bold text-stone-700 mb-4 text-center">ç»æœ›æ›²çº¿æ¨æ¼”</h3>
                    <div class="chart-container">
                        <canvas id="entropyChart"></canvas>
                    </div>
                    <div class="mt-4 text-center">
                         <span id="analysisResult" class="text-sm font-mono text-stone-600 bg-stone-100 px-3 py-1 rounded"></span>
                    </div>
                </div>
            </div>
        </section>

        <section id="status" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 h-[calc(100vh-140px)]">
                <div class="bg-white rounded-xl shadow-lg border border-stone-200 p-6 overflow-y-auto">
                    <h2 class="text-xl font-serif-header text-stone-900 mb-6">HUD çŠ¶æ€æ¨¡æ‹Ÿ</h2>
                    <div class="space-y-5">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs text-stone-500 uppercase tracking-wide mb-1">ç”Ÿå‘½ (Phys)</label>
                                <input type="text" id="hudHP" value="68% (å·¦è‡‚æ„ŸæŸ“)" class="w-full border border-stone-300 rounded p-2 text-sm focus:border-red-800 focus:ring-1 focus:ring-red-800" oninput="updateHUD()">
                            </div>
                            <div>
                                <label class="block text-xs text-stone-500 uppercase tracking-wide mb-1">ç²¾ç¥ (Mind)</label>
                                <input type="text" id="hudSAN" value="42% (ä½è¯­)" class="w-full border border-stone-300 rounded p-2 text-sm focus:border-red-800 focus:ring-1 focus:ring-red-800" oninput="updateHUD()">
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs text-stone-500 uppercase tracking-wide mb-1">å¼‚åŒ–åº¦ (Corruption)</label>
                            <input type="range" id="hudCorrRange" min="0" max="100" value="15" class="w-full h-2 bg-stone-200 rounded-lg accent-purple-900 mb-2" oninput="document.getElementById('hudCorrDisp').innerText=this.value+'%'; updateHUD()">
                            <span id="hudCorrDisp" class="text-xs font-mono text-purple-900">15%</span>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs text-stone-500 uppercase tracking-wide mb-1">é‡‘å¸</label>
                                <input type="text" id="hudGold" value="12" class="w-full border border-stone-300 rounded p-2 text-sm" oninput="updateHUD()">
                            </div>
                            <div>
                                <label class="block text-xs text-stone-500 uppercase tracking-wide mb-1">çµé­‚åˆ»</label>
                                <input type="text" id="hudSoul" value="0" class="w-full border border-stone-300 rounded p-2 text-sm bg-stone-100" oninput="updateHUD()">
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs text-stone-500 uppercase tracking-wide mb-1">ç¯å¢ƒå‹å¼º (Hidden)</label>
                            <select id="hudPressure" class="w-full border border-stone-300 rounded p-2 text-sm" onchange="updateHUD()">
                                <option value="æ­£å¸¸">æ­£å¸¸</option>
                                <option value="ä»¤äººçª’æ¯" selected>ä»¤äººçª’æ¯</option>
                                <option value="æ­»å¯‚">æ­»å¯‚</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs text-stone-500 uppercase tracking-wide mb-1">å°è®° (Tags)</label>
                            <input type="text" id="hudTags" value="[é¥¥é¥¿], [è¢«æ³¨è§†]" class="w-full border border-stone-300 rounded p-2 text-sm" oninput="updateHUD()">
                        </div>
                    </div>
                </div>

                <div class="bg-stone-900 rounded-xl shadow-lg border border-stone-700 p-6 flex flex-col">
                    <h3 class="text-stone-500 text-xs uppercase tracking-widest mb-2">YAML Output Preview</h3>
                    <textarea id="yamlOutput" class="flex-grow bg-transparent font-mono-code text-sm text-green-500 resize-none focus:outline-none" readonly></textarea>
                    <button onclick="navigator.clipboard.writeText(document.getElementById('yamlOutput').value)" class="mt-4 text-xs text-stone-400 hover:text-white text-right w-full">ç‚¹å‡»å¤åˆ¶ YAML</button>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- Navigation ---
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => {
                el.classList.add('hidden');
                el.classList.remove('block', 'animate-fade-in');
            });
            const target = document.getElementById(tabId);
            target.classList.remove('hidden');
            target.classList.add('block', 'animate-fade-in');

            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.dataset.target === tabId) {
                    btn.className = "nav-btn text-red-900 font-medium hover:text-red-700 transition-colors border-b-2 border-red-900";
                } else {
                    btn.className = "nav-btn text-stone-500 hover:text-red-900 transition-colors border-b-2 border-transparent";
                }
            });

            if (tabId === 'entropy') renderEntropyChart();
            if (tabId === 'status') updateHUD();
        }

        // --- Core Function: Copy System Prompt ---
        function copySystemPrompt() {
            const text = document.getElementById('systemPrompt').value;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.getElementById('copyBtn');
                const icon = document.getElementById('copyIcon');
                const label = document.getElementById('copyText');
                
                // Visual Feedback
                btn.classList.remove('bg-red-900', 'hover:bg-red-800');
                btn.classList.add('bg-green-700', 'hover:bg-green-600');
                icon.innerText = "âœ“";
                label.innerText = "å·²å¤åˆ¶æŒ‡ä»¤";
                
                setTimeout(() => {
                    btn.classList.add('bg-red-900', 'hover:bg-red-800');
                    btn.classList.remove('bg-green-700', 'hover:bg-green-600');
                    icon.innerText = "ğŸ“‹";
                    label.innerText = "å¤åˆ¶ç³»ç»ŸæŒ‡ä»¤";
                }, 2000);
            });
        }

        // --- Chart: Entropy Simulation ---
        let entropyChart = null;
        function renderEntropyChart() {
            const ctx = document.getElementById('entropyChart').getContext('2d');
            const initialHope = parseInt(document.getElementById('initialHope').value);
            const baseDecay = parseInt(document.getElementById('decayRate').value);
            const isTrap = document.getElementById('glimmerTrap').checked;
            
            document.getElementById('hopeVal').innerText = initialHope;
            document.getElementById('decayVal').innerText = baseDecay;

            let labels = [];
            let data = [];
            let hope = initialHope;
            let currentDecay = baseDecay;
            let deathTurn = -1;

            for(let i=0; i<=30; i++) {
                labels.push(i);
                data.push(Math.max(0, Math.floor(hope)));
                
                if (hope <= 0 && deathTurn === -1) deathTurn = i;

                if (isTrap && i === 5) {
                    hope += 15; // The Bait
                    currentDecay = baseDecay * 3; // The Debt
                } else {
                    hope -= currentDecay;
                }
            }

            // Update Text Analysis
            const resultEl = document.getElementById('analysisResult');
            if(deathTurn > -1) {
                resultEl.innerHTML = `é¢„è®¡å­˜æ´»: ${deathTurn} å›åˆ | æ¨¡å¼: ${isTrap ? 'å¾®å…‰é™·é˜± (é«˜é£é™©)' : 'çº¿æ€§è¡°å‡'}`;
                resultEl.className = "text-sm font-mono text-red-800 bg-red-100 px-3 py-1 rounded";
            } else {
                resultEl.innerHTML = "èµ„æºå……è¶³ï¼Œ30å›åˆå†…æ— ç”Ÿå­˜å¨èƒ";
                resultEl.className = "text-sm font-mono text-green-800 bg-green-100 px-3 py-1 rounded";
            }

            if (entropyChart) entropyChart.destroy();

            entropyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'å¸Œæœ›å€¼ (Hope)',
                        data: data,
                        borderColor: '#7f1d1d',
                        backgroundColor: 'rgba(127, 29, 29, 0.1)',
                        fill: true,
                        tension: 0.3,
                        pointRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, grid: { color: '#e7e5e4' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        // Listeners for Chart
        document.getElementById('initialHope').addEventListener('input', renderEntropyChart);
        document.getElementById('decayRate').addEventListener('input', renderEntropyChart);
        document.getElementById('glimmerTrap').addEventListener('change', renderEntropyChart);

        // --- YAML Generator ---
        function updateHUD() {
            const hp = document.getElementById('hudHP').value;
            const san = document.getElementById('hudSAN').value;
            const corr = document.getElementById('hudCorrRange').value;
            const gold = document.getElementById('hudGold').value;
            const soul = document.getElementById('hudSoul').value;
            const pressure = document.getElementById('hudPressure').value;
            const tags = document.getElementById('hudTags').value.split(',').map(s => s.trim()).filter(s=>s);
            
            const date = new Date();
            const dateStr = `${date.getMonth()+1}/${date.getDate()}`;

            let yaml = `---
[æ—¶ç©º]: "è£‚éš™301å¹´ Â· ${dateStr} Â· é˜´éœ¾"
[æ¨¡å¼]: "å†’é™©è€…"
[ç”Ÿç†]:
  ç”Ÿå‘½: "${hp}"
  ç²¾ç¥: "${san}"
  å¼‚åŒ–åº¦: "${corr}%"
[èµ„äº§]:
  é‡‘å¸: "${gold}"
  çµé­‚åˆ»: "${soul}"
[æ°›å›´]:
  ç¯å¢ƒå‹å¼º: "${pressure}"
  å› æœå›å“: "ä½ çš„é€‰æ‹©å¼•èµ·äº†è™šç©ºçš„æ³¨æ„..."
[å°è®°]:
${tags.map(t => `  - "${t}"`).join('\n')}
---`;
            document.getElementById('yamlOutput').value = yaml;
        }

        // Init
        window.onload = function() {
            renderEntropyChart();
            updateHUD();
        }
    </script>
</body>
</html>
