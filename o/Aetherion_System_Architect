<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aetherion: System Architect Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e7e5e4; 
        }
        ::-webkit-scrollbar-thumb {
            background: #78716c; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #57534e; 
        }

        /* Chart Container Specifics */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Typography */
        .font-serif-header {
            font-family: 'Georgia', 'Times New Roman', serif;
        }
        .font-mono-code {
            font-family: 'Courier New', Courier, monospace;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Stone) with Deep Red Accents. Maintains light background requirement. -->
    <!-- Application Structure Plan: 
         1. Overview: Quick stats of the prompt.
         2. Entropy Lab: Visualizing the decay of Hope/Sanity (Economic Stress Test).
         3. Logic Core: Addressing the Deus Ex vs Observer conflict (Debug/Patch).
         4. Token Forge: Demonstrating compression techniques (Optimization).
         5. Output Preview: Interactive Status Bar generator.
    -->
    <!-- Visualization & Content Choices:
         - Chart.js Line Chart: To show the "Hope Decay" curve over turns.
         - Chart.js Bar Chart: To show success/failure distribution based on difficulty.
         - Interactive HTML/JS Panels: For the Prompt comparison and Status Bar builder.
         - Justification: Visualizing the math behind the "despair" makes the system tuning easier.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-stone-50 text-stone-800 font-sans antialiased selection:bg-red-200 selection:text-red-900">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-stone-100/90 backdrop-blur-md border-b border-stone-300 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-red-900 font-serif-header tracking-wider">AETHERION <span class="text-stone-500 text-sm font-normal font-sans">| ç³»ç»Ÿæ¶æ„å°</span></span>
                </div>
                <div class="hidden md:flex space-x-8 items-center">
                    <button onclick="switchTab('overview')" class="nav-btn text-red-900 font-medium hover:text-red-700 transition-colors border-b-2 border-red-900" data-target="overview">æ¦‚è§ˆ</button>
                    <button onclick="switchTab('entropy')" class="nav-btn text-stone-500 hover:text-red-900 transition-colors border-b-2 border-transparent" data-target="entropy">ç†µå€¼ç»æµ</button>
                    <button onclick="switchTab('logic')" class="nav-btn text-stone-500 hover:text-red-900 transition-colors border-b-2 border-transparent" data-target="logic">é€»è¾‘ä¿®å¤</button>
                    <button onclick="switchTab('optimization')" class="nav-btn text-stone-500 hover:text-red-900 transition-colors border-b-2 border-transparent" data-target="optimization">Tokenå‹ç¼©</button>
                    <button onclick="switchTab('status')" class="nav-btn text-stone-500 hover:text-red-900 transition-colors border-b-2 border-transparent" data-target="status">çŠ¶æ€æ </button>
                </div>
                <!-- Mobile menu button simplified -->
                <div class="md:hidden flex items-center">
                    <button class="text-stone-500 hover:text-red-900">â˜°</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">

        <!-- SECTION 1: OVERVIEW -->
        <section id="overview" class="tab-content block animate-fade-in">
            <div class="bg-white rounded-xl shadow-lg border border-stone-200 p-8">
                <h2 class="text-3xl font-serif-header text-stone-900 mb-4 border-b pb-2 border-stone-200">ç³»ç»Ÿå®¡è®¡æŠ¥å‘Š: Aetherion v1</h2>
                <p class="text-stone-600 mb-6 leading-relaxed">
                    æœ¬æ§åˆ¶å°æ—¨åœ¨è¾…åŠ© <span class="font-bold text-red-800">Prompt Engineer</span> å¯¹ã€ŠAetherionã€‹TRPG ç³»ç»Ÿè¿›è¡Œæ·±åº¦ä¼˜åŒ–ã€‚
                    å½“å‰ç‰ˆæœ¬æ ¸å¿ƒç—›ç‚¹ä¸º Token æ¶ˆè€—è¿‡å¤§ã€é€»è¾‘è¾¹ç¼˜å†²çªï¼ˆé™ç¥ vs è§‚å¯Ÿè€…ï¼‰ä»¥åŠçŠ¶æ€æ è¾“å‡ºçš„ä¸ç¨³å®šæ€§ã€‚
                    ä¸‹æ–¹æ¨¡å—å°†åˆ†åˆ«é’ˆå¯¹è¿™ä¸‰ä¸ªç»´åº¦è¿›è¡Œå¯è§†åŒ–åˆ†æä¸é‡æ„ã€‚
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Metric Card 1 -->
                    <div class="bg-stone-50 rounded-lg p-6 border border-stone-200 hover:border-red-300 transition-all">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="text-lg font-bold text-stone-700">Token å†—ä½™åº¦</h3>
                            <span class="text-2xl text-red-600">âš ï¸ High</span>
                        </div>
                        <p class="text-sm text-stone-500">æ£€æµ‹åˆ°å¤§é‡é‡å¤çš„â€œæå“å¼â€æŒ‡ä»¤ï¼ˆå¦‚åå¤å¼ºè°ƒâ€œä¸¥ç¦â€ï¼‰ã€‚å»ºè®®ç»“æ„åŒ–å‹ç¼©ã€‚</p>
                        <div class="mt-4 w-full bg-stone-200 rounded-full h-2">
                            <div class="bg-red-600 h-2 rounded-full" style="width: 85%"></div>
                        </div>
                        <p class="text-xs text-right mt-1 text-stone-400">é¢„è®¡å¯å‹ç¼©ç©ºé—´: 40%</p>
                    </div>

                    <!-- Metric Card 2 -->
                    <div class="bg-stone-50 rounded-lg p-6 border border-stone-200 hover:border-amber-300 transition-all">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="text-lg font-bold text-stone-700">é€»è¾‘å®Œæ•´æ€§</h3>
                            <span class="text-2xl text-amber-600">âš¡ Conflict</span>
                        </div>
                        <p class="text-sm text-stone-500">3.20ï¼ˆé™ç¥ï¼‰ä¸ 3.7ï¼ˆè§‚å¯Ÿè€…ï¼‰å­˜åœ¨ä¼˜å…ˆçº§å†²çªã€‚éœ€å®šä¹‰ User/Character è¾¹ç•Œã€‚</p>
                        <div class="mt-4 w-full bg-stone-200 rounded-full h-2">
                            <div class="bg-amber-500 h-2 rounded-full" style="width: 60%"></div>
                        </div>
                        <p class="text-xs text-right mt-1 text-stone-400">é€»è¾‘é£é™©: ä¸­ç­‰</p>
                    </div>

                    <!-- Metric Card 3 -->
                    <div class="bg-stone-50 rounded-lg p-6 border border-stone-200 hover:border-green-300 transition-all">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="text-lg font-bold text-stone-700">æ°›å›´æ¸²æŸ“</h3>
                            <span class="text-2xl text-green-700">âœ” Excellent</span>
                        </div>
                        <p class="text-sm text-stone-500">â€œç»æœ›/å…‹è‹é²/é»‘é­‚â€åŸºè°ƒç¨³å›ºã€‚ä¼˜åŒ–æ—¶éœ€ç¡®ä¿æ­¤æ ¸å¿ƒä½“éªŒä¸è¢«â€œè¿‡åº¦å‹ç¼©â€ç¨€é‡Šã€‚</p>
                        <div class="mt-4 w-full bg-stone-200 rounded-full h-2">
                            <div class="bg-green-700 h-2 rounded-full" style="width: 95%"></div>
                        </div>
                        <p class="text-xs text-right mt-1 text-stone-400">ä¿ç•™ä¼˜å…ˆçº§: æœ€é«˜</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: ENTROPY ECONOMY (MATH SIMULATOR) -->
        <section id="entropy" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Controls -->
                <div class="lg:col-span-1 space-y-6">
                    <div class="bg-white rounded-xl shadow-lg border border-stone-200 p-6">
                        <h2 class="text-2xl font-serif-header text-stone-900 mb-4">æ•°å€¼å‹åŠ›æµ‹è¯•</h2>
                        <p class="text-sm text-stone-500 mb-6">
                            æ¨¡æ‹Ÿç©å®¶åœ¨â€œå¾®å…‰é™·é˜±â€æœºåˆ¶ä¸‹çš„ç”Ÿå­˜æ›²çº¿ã€‚æµ‹è¯•æ˜¯å¦å­˜åœ¨æ•°å€¼å´©åæˆ–è¿‡æ—©æ­»äº¡ã€‚
                        </p>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-stone-700 mb-1">åˆå§‹å¸Œæœ›å€¼ (Hope)</label>
                                <input type="range" id="initialHope" min="10" max="100" value="50" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-red-900">
                                <span id="hopeVal" class="text-xs font-mono text-red-800">50</span>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-stone-700 mb-1">åŸºç¡€æ¶ˆè€—é€Ÿç‡ (æ¯å›åˆ)</label>
                                <input type="range" id="decayRate" min="1" max="10" value="2" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-stone-600">
                                <span id="decayVal" class="text-xs font-mono text-stone-600">2</span>
                            </div>

                            <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-100">
                                <span class="text-sm font-bold text-red-900">æ¿€æ´»â€œå¾®å…‰é™·é˜±â€</span>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="glimmerTrap" class="sr-only peer">
                                    <div class="w-11 h-6 bg-stone-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-stone-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-800"></div>
                                </label>
                            </div>
                            <p class="text-xs text-stone-400 italic">
                                å¾®å…‰é™·é˜±ï¼šç»™äºˆå°‘é‡å›å¤ï¼Œä½†å¤§å¹…å¢åŠ åç»­æ¶ˆè€—å€ç‡ã€‚
                            </p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg border border-stone-200 p-6">
                         <h3 class="text-lg font-bold text-stone-800 mb-2">åˆ†æç»“è®º</h3>
                         <div id="economyAnalysis" class="text-sm text-stone-600 leading-relaxed">
                             å½“å‰å‚æ•°ä¸‹ï¼Œç©å®¶å°†åœ¨çº¦ <span class="font-bold text-red-700">25</span> å›åˆåè€—å°½å¸Œæœ›ã€‚å¾®å…‰é™·é˜±ä¼šåˆ¶é€ â€œè™šå‡ç¹è£â€ï¼Œéšåå¯¼è‡´æ–­å´–å¼å´©ç›˜ã€‚
                         </div>
                    </div>
                </div>

                <!-- Visualization -->
                <div class="lg:col-span-2 bg-white rounded-xl shadow-lg border border-stone-200 p-6 flex flex-col justify-center">
                    <h3 class="text-lg font-bold text-stone-700 mb-4 text-center">å¸Œæœ›å€¼è¡°å‡æ¨¡å‹ (Entropy Curve)</h3>
                    <div class="chart-container">
                        <canvas id="entropyChart"></canvas>
                    </div>
                    <div class="mt-4 text-center text-xs text-stone-400">
                        Xè½´: æ¸¸æˆå›åˆ / Yè½´: å‰©ä½™å¸Œæœ›å€¼
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: LOGIC DEBUGGER -->
        <section id="logic" class="tab-content hidden">
            <div class="bg-white rounded-xl shadow-lg border border-stone-200 p-8 mb-8">
                <div class="border-l-4 border-amber-500 pl-4 mb-6">
                    <h2 class="text-2xl font-serif-header text-stone-900">é€»è¾‘å†²çªæ£€æµ‹: 3.20 vs 3.7</h2>
                    <p class="text-stone-600 mt-2">
                        <span class="font-mono bg-stone-100 px-1 rounded text-red-800">é™ç¥è¦†å†™ (Deus Ex)</span> å…è®¸æ”¹å†™åº•å±‚è§„åˆ™ï¼Œè€Œ 
                        <span class="font-mono bg-stone-100 px-1 rounded text-blue-800">è§‚å¯Ÿè€…æ¨¡å¼ (Observer)</span> è¦æ±‚ç»å¯¹ä¸å¹²æ¶‰ä¸”æ— æ•Œã€‚
                        <br>
                        <strong>æ¼æ´ï¼š</strong> ç©å®¶è‹¥å¼€å¯è§‚å¯Ÿè€…æ¨¡å¼è·å¾—â€œæ— æ•Œâ€ï¼Œå†è§¦å‘é™ç¥æ¨¡å¼ä¿®æ”¹â€œæ— æ•Œâ€çš„å®šä¹‰ï¼Œå¯èƒ½å¯¼è‡´é€»è¾‘æ­»å¾ªç¯æˆ–AIèº«ä»½æ··æ·†ã€‚
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Current Problem State -->
                    <div class="bg-stone-50 p-6 rounded-lg border border-stone-200">
                        <h3 class="font-bold text-red-900 mb-4 flex items-center">ğŸš« å½“å‰é€»è¾‘ (Conflict)</h3>
                        <ul class="space-y-3 text-sm text-stone-700">
                            <li class="flex items-start">
                                <span class="mr-2">1.</span> ç©å®¶è¿›å…¥è§‚å¯Ÿè€…æ¨¡å¼ -> è·å¾— [ç»å¯¹ä¸å¯è§¦ç¢°] æ ‡ç­¾ã€‚
                            </li>
                            <li class="flex items-start">
                                <span class="mr-2">2.</span> ç©å®¶æ¿€æ´»é™ç¥åè®® -> è¯·æ±‚åˆ é™¤ [ç»å¯¹ä¸å¯è§¦ç¢°] æ¦‚å¿µã€‚
                            </li>
                            <li class="flex items-start">
                                <span class="mr-2">3.</span> <span class="bg-red-100 text-red-800 px-1">SYSTEM ERROR:</span> è§‚å¯Ÿè€…æ¨¡å¼é“å¾‹ç¦æ­¢æ›´æ”¹è‡ªèº«çŠ¶æ€ï¼Œä½†é™ç¥åè®®ä¼˜å…ˆçº§å·ç§°æœ€é«˜ã€‚
                            </li>
                            <li class="flex items-start">
                                <span class="mr-2">4.</span> ç»“æœï¼šAI å¯èƒ½ä¼šäº§ç”Ÿå¹»è§‰ï¼Œæˆ–è€…æ‰“ç ´â€œGMâ€ä¸â€œä¸–ç•Œâ€çš„ç¬¬å››é¢å¢™ã€‚
                            </li>
                        </ul>
                    </div>

                    <!-- Proposed Solution -->
                    <div class="bg-stone-50 p-6 rounded-lg border border-stone-200">
                        <h3 class="font-bold text-green-800 mb-4 flex items-center">âœ… ä¿®å¤æ–¹æ¡ˆ (Patch v2.0)</h3>
                        <div class="text-sm space-y-4">
                            <div class="bg-white p-3 rounded border border-stone-300 shadow-sm">
                                <strong class="block text-stone-800 mb-1">æ–°å¢å®šä¹‰ï¼šUser / Character è¾¹ç•Œ</strong>
                                <p class="text-stone-600">æ˜ç¡®â€œé™ç¥â€æ˜¯ User (ç©å®¶æœ¬äºº) çš„æƒé™ï¼Œè€Œâ€œè§‚å¯Ÿè€…â€æ˜¯ Character (è§’è‰²) çš„çŠ¶æ€ã€‚</p>
                            </div>
                            <div class="bg-white p-3 rounded border border-stone-300 shadow-sm">
                                <strong class="block text-stone-800 mb-1">ä¼˜å…ˆçº§é‡æ’</strong>
                                <p class="text-stone-600 font-mono text-xs">
                                    IF (é™ç¥åè®®_Active) {<br>
                                    &nbsp;&nbsp;å¼ºåˆ¶è§£é™¤_æ‰€æœ‰_è§’è‰²æ¨¡æ€ (åŒ…æ‹¬è§‚å¯Ÿè€…);<br>
                                    &nbsp;&nbsp;è¿›å…¥_ç¼–è¾‘æ¨¡å¼;<br>
                                    }<br>
                                    ELSE IF (è§‚å¯Ÿè€…_Mode) { ... }
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: TOKEN OPTIMIZATION -->
        <section id="optimization" class="tab-content hidden">
            <div class="bg-white rounded-xl shadow-lg border border-stone-200 p-8">
                <h2 class="text-2xl font-serif-header text-stone-900 mb-6">Prompt å‹ç¼©å®éªŒå®¤</h2>
                <p class="text-stone-600 mb-6">
                    é€šè¿‡å°†è‡ªç„¶è¯­è¨€è½¬åŒ–ä¸ºâ€œä¼ªä»£ç â€å’Œâ€œç»“æ„åŒ–çº¦æŸâ€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¿æŒæ ¸å¿ƒé€»è¾‘çš„å‰æä¸‹å¤§å¹…å‡å°‘ Token æ¶ˆè€—ã€‚
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-0 border border-stone-300 rounded-lg overflow-hidden">
                    <!-- Before -->
                    <div class="bg-red-50 p-6 border-b md:border-b-0 md:border-r border-stone-300">
                        <h3 class="text-xs font-bold uppercase tracking-widest text-red-900 mb-4">åŸå§‹ç‰ˆæœ¬ (Verbose)</h3>
                        <div class="font-mono-code text-xs text-stone-600 whitespace-pre-wrap h-64 overflow-y-auto">
3.6 èµ„æºæ‰£é™¤è§„åˆ™
ä¸¥ç¦å¿˜è®°æ‰£é™¤èµ„æºã€‚æ¯ä¸€æ¬¡è¡ŒåŠ¨ï¼Œæ— è®ºå¤§å°ï¼Œéƒ½å¿…é¡»äº§ç”Ÿæ¶ˆè€—ã€‚å¦‚æœç©å®¶è¯•å›¾ä¼‘æ¯ï¼Œè¿™ä¸ç®—è¡ŒåŠ¨ï¼Œä½†ä¹Ÿå¿…é¡»æ‰£é™¤â€œæ—¶é—´æµé€â€å¸¦æ¥çš„ç”Ÿå­˜å€¼ã€‚
3.16 å¾®å…‰é™·é˜±
å¦‚æœç©å®¶è·å¾—äº†æ„å¤–çš„å¥½è¿ï¼Œè¿™é€šå¸¸æ˜¯æŸç§é™·é˜±ã€‚ç³»ç»Ÿå¿…é¡»è®°å½•è¿™ä¸€æ¬¡å¥½è¿ï¼Œå¹¶åœ¨æœªæ¥çš„æŸä¸ªæ—¶åˆ»ï¼Œä»¥ä¸¤å€çš„æ¶æ„è¿”è¿˜ç»™ç©å®¶ã€‚ç»ä¸è¦è®©ç©å®¶è§‰å¾—å¥½è¿æ˜¯å…è´¹çš„ã€‚è¿™éå¸¸é‡è¦ã€‚
3.17 å€ºåŠ¡
å½“å¥½è¿å‘ç”Ÿæ—¶ï¼Œè®°å½•å€ºåŠ¡ã€‚å€ºåŠ¡å¿…é¡»åœ¨3ä¸ªå›åˆå†…å¿è¿˜ã€‚
                        </div>
                        <p class="mt-2 text-xs text-red-700 font-bold">Token ä¼°ç®—: ~150 tokens</p>
                    </div>

                    <!-- After -->
                    <div class="bg-green-50 p-6">
                        <h3 class="text-xs font-bold uppercase tracking-widest text-green-900 mb-4">ä¼˜åŒ–ç‰ˆæœ¬ (Compressed Logic)</h3>
                        <div class="font-mono-code text-xs text-stone-800 whitespace-pre-wrap h-64 overflow-y-auto">
# Core Logic: Entropy & Karma
[Rule_Cost]: ACTION_COST = (Base: 1d5) + (Time_Pass: 1d3). Apply to {HP, Hope} every turn. NO EXCEPTIONS.

[Rule_GlimmerTrap]:
IF (Player_Success == Critical OR Loot > Average):
  1. Trigger "Glimmer_Event" (Small immediate gain).
  2. Set Hidden_Flag: {Karma_Debt = Gain * 2}.
  3. Execute {Karma_Payback} within 3 turns via "Cruel_Twist".

[Constraint]: "Free Lunch" == Forbidden.
                        </div>
                        <p class="mt-2 text-xs text-green-700 font-bold">Token ä¼°ç®—: ~65 tokens (-56%)</p>
                    </div>
                </div>

                <div class="mt-8 flex justify-center">
                    <button class="bg-stone-800 text-stone-100 px-6 py-2 rounded-lg hover:bg-stone-700 transition-colors shadow-lg flex items-center gap-2">
                        <span>ğŸ“‹ å¤åˆ¶å®Œæ•´ä¼˜åŒ–ç‰ˆ Prompt (v2.0)</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- SECTION 5: STATUS BAR BUILDER -->
        <section id="status" class="tab-content hidden">
             <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Input Configuration -->
                <div class="bg-white rounded-xl shadow-lg border border-stone-200 p-6">
                    <h2 class="text-xl font-serif-header text-stone-900 mb-4">çŠ¶æ€æ ç”Ÿæˆå™¨ (YAML Architect)</h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-stone-500 uppercase">è¾“å‡ºæ¨¡å¼</label>
                            <div class="flex gap-4 mt-2">
                                <label class="flex items-center space-x-2">
                                    <input type="radio" name="formatMode" value="legacy" onclick="updateStatusPreview()" class="accent-red-900">
                                    <span class="text-sm">ä¼ ç»Ÿ (Verbose)</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="radio" name="formatMode" value="optimized" checked onclick="updateStatusPreview()" class="accent-green-700">
                                    <span class="text-sm font-bold text-green-800">æç®€ (Tokens Saver)</span>
                                </label>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs text-stone-500 mb-1">HP (Life)</label>
                                <input type="number" id="inputHP" value="75" class="w-full border border-stone-300 rounded p-2 text-sm" oninput="updateStatusPreview()">
                            </div>
                            <div>
                                <label class="block text-xs text-stone-500 mb-1">SAN (Mind)</label>
                                <input type="number" id="inputSAN" value="40" class="w-full border border-stone-300 rounded p-2 text-sm" oninput="updateStatusPreview()">
                            </div>
                            <div>
                                <label class="block text-xs text-stone-500 mb-1">HOPE (Soul)</label>
                                <input type="number" id="inputHope" value="12" class="w-full border border-stone-300 rounded p-2 text-sm bg-red-50 text-red-900" oninput="updateStatusPreview()">
                            </div>
                            <div>
                                <label class="block text-xs text-stone-500 mb-1">Gold (Greed)</label>
                                <input type="number" id="inputGold" value="150" class="w-full border border-stone-300 rounded p-2 text-sm" oninput="updateStatusPreview()">
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs text-stone-500 mb-1">å½“å‰çŠ¶æ€ (Debuffs)</label>
                            <input type="text" id="inputStatus" value="Hungry, Paranoid" class="w-full border border-stone-300 rounded p-2 text-sm" oninput="updateStatusPreview()">
                        </div>
                    </div>
                </div>

                <!-- Code Output -->
                <div class="bg-stone-900 rounded-xl shadow-lg border border-stone-700 p-6 flex flex-col relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-2 opacity-20">
                        <span class="text-6xl">âš™ï¸</span>
                    </div>
                    <h3 class="text-stone-400 text-xs uppercase tracking-widest mb-4">LLM Output Preview</h3>
                    <pre id="codePreview" class="font-mono-code text-sm text-green-400 whitespace-pre overflow-auto flex-grow"></pre>
                    
                    <div class="mt-4 pt-4 border-t border-stone-700 flex justify-between items-center">
                         <span class="text-xs text-stone-500" id="tokenCount">Est. Tokens: 0</span>
                         <span class="text-xs text-stone-500">YAML Block</span>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-stone-100 border-t border-stone-200 mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-stone-500 text-sm">Aetherion System Architect Â© 2026</p>
            <p class="text-stone-400 text-xs mt-2">Designed for Deep Research & Prompt Optimization</p>
        </div>
    </footer>

    <!-- JS Logic -->
    <script>
        // State Management
        const state = {
            currentTab: 'overview',
            entropyChart: null,
            hopeHistory: [],
            decayMode: 'normal' // normal or trap
        };

        // Navigation Logic
        function switchTab(tabId) {
            // Hide all sections
            document.querySelectorAll('.tab-content').forEach(el => {
                el.classList.add('hidden');
                el.classList.remove('block', 'animate-fade-in');
            });
            
            // Show target section
            const target = document.getElementById(tabId);
            target.classList.remove('hidden');
            target.classList.add('block', 'animate-fade-in');

            // Update Nav Styles
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.dataset.target === tabId) {
                    btn.classList.remove('text-stone-500', 'border-transparent');
                    btn.classList.add('text-red-900', 'border-red-900', 'font-medium');
                } else {
                    btn.classList.add('text-stone-500', 'border-transparent');
                    btn.classList.remove('text-red-900', 'border-red-900', 'font-medium');
                }
            });

            // Trigger specific renders
            if (tabId === 'entropy') renderEntropyChart();
            if (tabId === 'status') updateStatusPreview();
        }

        // --- CHART: Entropy Economy ---
        function renderEntropyChart() {
            const ctx = document.getElementById('entropyChart').getContext('2d');
            
            // Get inputs
            const initialHope = parseInt(document.getElementById('initialHope').value);
            const baseDecay = parseInt(document.getElementById('decayRate').value);
            const isTrap = document.getElementById('glimmerTrap').checked;

            // Update Labels
            document.getElementById('hopeVal').innerText = initialHope;
            document.getElementById('decayVal').innerText = baseDecay;

            // Simulation Logic
            let labels = [];
            let dataNormal = [];
            let dataTrap = [];
            
            // Sim Normal
            let hope = initialHope;
            for(let i=0; i<=25; i++) {
                labels.push(`T${i}`);
                dataNormal.push(Math.max(0, hope));
                hope -= baseDecay;
                if(hope < 0) hope = 0;
            }

            // Sim Trap (Glimmer)
            hope = initialHope;
            let currentDecay = baseDecay;
            let trapTriggered = false;

            for(let i=0; i<=25; i++) {
                dataTrap.push(Math.max(0, Math.floor(hope)));
                
                // Trap Logic: Trigger at turn 5
                if(isTrap && i === 5) {
                    hope += 15; // The bait
                    currentDecay = baseDecay * 2.5; // The debt
                    trapTriggered = true;
                } else {
                    hope -= currentDecay;
                }
                
                if(hope < 0) hope = 0;
            }

            // Update Analysis Text
            const turnZero = isTrap 
                ? dataTrap.findIndex(v => v === 0) 
                : dataNormal.findIndex(v => v === 0);
            
            const analysisEl = document.getElementById('economyAnalysis');
            if (turnZero === -1) {
                analysisEl.innerHTML = "èµ„æºå°šæœªè€—å°½ã€‚å½“å‰è®¾ç½®ä¸‹ç”Ÿå­˜å‹åŠ›è¾ƒå°ã€‚";
            } else {
                let text = `é¢„è®¡å­˜æ´»å›åˆ: <span class="font-bold text-red-700">${turnZero}</span>ã€‚`;
                if(isTrap) text += ` å¾®å…‰é™·é˜±å¯¼è‡´åæœŸè¡°å‡é€Ÿåº¦æ¿€å¢ (x2.5)ï¼Œæ¯”æ­£å¸¸æ¨¡å¼å¿« <span class="font-bold">${dataNormal.findIndex(v=>v===0) - turnZero}</span> å›åˆæ­»äº¡ã€‚`;
                analysisEl.innerHTML = text;
            }

            // Destroy old chart if exists
            if (state.entropyChart) state.entropyChart.destroy();

            // Create new Chart
            state.entropyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'æ­£å¸¸æ¶ˆè€—',
                            data: dataNormal,
                            borderColor: '#a8a29e', // stone-400
                            borderDash: [5, 5],
                            tension: 0.4,
                            pointRadius: 2
                        },
                        {
                            label: isTrap ? 'å¾®å…‰é™·é˜± (è¯±é¥µ+é«˜å€º)' : 'å½“å‰è®¾ç½®',
                            data: isTrap ? dataTrap : dataNormal,
                            borderColor: '#7f1d1d', // red-900
                            backgroundColor: 'rgba(127, 29, 29, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + ' Hope';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Hope / Soul' },
                            grid: { color: '#e7e5e4' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        // Add Listeners for Simulation
        document.getElementById('initialHope').addEventListener('input', renderEntropyChart);
        document.getElementById('decayRate').addEventListener('input', renderEntropyChart);
        document.getElementById('glimmerTrap').addEventListener('change', renderEntropyChart);


        // --- STATUS BAR BUILDER ---
        function updateStatusPreview() {
            const mode = document.querySelector('input[name="formatMode"]:checked').value;
            const hp = document.getElementById('inputHP').value;
            const san = document.getElementById('inputSAN').value;
            const hope = document.getElementById('inputHope').value;
            const gold = document.getElementById('inputGold').value;
            const statusRaw = document.getElementById('inputStatus').value;
            const statusList = statusRaw.split(',').map(s => s.trim()).filter(s => s);

            let output = "";
            let tokenEst = 0;

            if (mode === 'legacy') {
                // Verbose Format
                output = `\`\`\`yaml
Status:
  Health_Points: ${hp}/100
  Sanity_Level: ${san}/100
  Hope_Resource: ${hope}
  Inventory:
    Gold_Coins: ${gold}
  Conditions:
${statusList.map(s => `    - ${s}`).join('\n')}
\`\`\``;
                tokenEst = output.length / 3.5; // Rough est
            } else {
                // Optimized Format (Compressed)
                // Using emojis and short keys as requested in prompt dimensions
                output = `\`\`\`yaml
ST:
  HP: ${hp} ğŸ©¸
  SAN: ${san} ğŸ§ 
  HOPE: ${hope} ğŸ•¯ï¸
  $Au: ${gold}
  Buffs: [${statusList.join(', ')}]
\`\`\``;
                tokenEst = output.length / 3.5;
            }

            document.getElementById('codePreview').innerText = output;
            document.getElementById('tokenCount').innerText = `Est. Tokens: ~${Math.ceil(tokenEst)}`;
        }

        // Initialize
        window.onload = function() {
            renderEntropyChart();
            updateStatusPreview();
            
            // Animation class for tailwind
            const style = document.createElement('style');
            style.innerHTML = `
                @keyframes fade-in {
                    from { opacity: 0; transform: translateY(10px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                .animate-fade-in {
                    animation: fade-in 0.3s ease-out forwards;
                }
            `;
            document.head.appendChild(style);
        };

    </script>
</body>
</html>
