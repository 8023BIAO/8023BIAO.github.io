<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="refresh" content="5;url=https://biao.chat">
  <title>404 - 页面未找到</title>
  <style>
    :root {
      --primary-color: #0d47a1; 
      --bg-color: #f5f7fa;
      --module-bg: #ffffff;
      --result-bg: #f0f4f8;
      --text-color: #2c3e50;
      --label-color: #607d8b;
      --radius: 12px;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
    }
    [data-theme="dark"] {
      --primary-color: #64b5f6;
      --bg-color: #0a0a0a;
      --module-bg: #141414;
      --result-bg: #1e1e1e;
      --text-color: #e0e0e0;
      --label-color: #9e9e9e;
      --shadow: none;
    }
    body {
      background: var(--bg-color);
      color: var(--text-color);
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      transition: background-color 0.3s, color 0.3s;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    .theme-toggle {
      position: fixed;
      top: 24px;
      right: 24px;
      background: transparent;
      border: 1px solid var(--label-color);
      color: var(--text-color);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.85rem;
      cursor: pointer;
      opacity: 0.6;
      transition: all 0.3s;
      z-index: 100;
    }
    .theme-toggle:hover { opacity: 1; background: var(--text-color); color: var(--bg-color); border-color: var(--text-color); }
    .card-container { width: 100%; max-width: 480px; }
    .info-module { background: var(--module-bg); border-radius: var(--radius); padding: 40px 32px; box-shadow: var(--shadow); text-align: center; border: 1px solid rgba(0,0,0,0.03); }
    [data-theme="dark"] .info-module { border: 1px solid rgba(255,255,255,0.05); }
    .error-code { font-size: 5rem; font-weight: 800; color: var(--primary-color); margin: 0; line-height: 1; opacity: 0.9; font-family: 'Courier New', Courier, monospace; }
    .error-title { font-size: 1.5rem; font-weight: 600; margin: 10px 0 24px 0; color: var(--text-color); }
    .redirect-box { background: var(--result-bg); border-radius: var(--radius); padding: 20px; margin: 24px 0; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .redirect-text { font-size: 0.9rem; color: var(--label-color); margin-bottom: 8px; }
    .countdown-number { font-size: 2rem; font-weight: 700; color: var(--text-color); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
    .home-link { display: inline-block; margin-top: 10px; color: var(--primary-color); text-decoration: none; font-size: 0.95rem; font-weight: 500; padding-bottom: 2px; border-bottom: 1px dashed transparent; transition: all 0.3s; }
    .home-link:hover { border-bottom-color: var(--primary-color); opacity: 0.8; }
    .footer-hint { margin-top: 24px; font-size: 0.75rem; color: var(--label-color); opacity: 0.5; }
  </style>
</head>
<body>
  <button class="theme-toggle" id="theme-toggle-btn">暗色模式</button>
  <main class="card-container">
    <section class="info-module">
      <h1 class="error-code">404</h1>
      <h2 class="error-title">页面不存在</h2>
      <div class="redirect-box">
        <span class="redirect-text">正在自动返回首页</span>
        <span class="countdown-number" id="countdown">5</span>
      </div>
      <a href="https://biao.chat" class="home-link">如果没反应，请点击这里立即跳转 &rarr;</a>
    </section>
    <div class="footer-hint">biao.chat</div>
  </main>

  <script>
   // === 核心主题管理 (包含所有同步修复) ===
    const ThemeManager = {
      btn: document.getElementById('theme-toggle-btn'),
      
      // 执行应用主题
      apply() {
        const isDark = localStorage.getItem('theme') === 'dark';
        document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
        if(this.btn) this.btn.textContent = isDark ? '浅色模式' : '暗色模式';
      },

      init() {
        // 1. 立即执行一次
        this.apply();

        // 2. 点击切换
        if (this.btn) {
          this.btn.addEventListener('click', () => { 
            const isCurrentDark = document.body.getAttribute('data-theme') === 'dark';
            localStorage.setItem('theme', !isCurrentDark ? 'dark' : 'light');
            this.apply(); 
          });
        }

        // 3. 页面展示时 (解决后退缓存不刷新问题)
        window.addEventListener('pageshow', (event) => {
          // event.persisted 表示页面是从缓存中读取的
          this.apply();
        });

        // 4. 跨标签页同步 (解决多开窗口问题)
        window.addEventListener('storage', (event) => {
          if (event.key === 'theme') {
            this.apply();
          }
        });
      }
    };

    const RedirectManager = {
      config: { targetUrl: 'https://biao.chat', seconds: 5 },
      init() {
        const el = document.getElementById('countdown');
        let remaining = this.config.seconds;
        el.textContent = remaining;
        const timer = setInterval(() => {
          remaining--;
          el.textContent = remaining > 0 ? remaining : 0;
          if (remaining <= 0) {
            clearInterval(timer);
            window.location.replace(this.config.targetUrl);
          }
        }, 1000);
      }
    };

    window.addEventListener('DOMContentLoaded', () => {
      ThemeManager.init();
      RedirectManager.init();
    });
  </script>
</body>
</html>
